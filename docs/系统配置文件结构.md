# 系统配置文件结构

本文档用于描述“学生会值班管理系统”的配置项组织方式，便于部署、运维与多环境（dev/test/prod）切换。

## 1. 配置来源与优先级

建议优先使用环境变量（Env）覆盖配置文件，以适配容器化部署：

1. 环境变量（最高优先级）
2. 配置文件（例如：`config.yaml`）
3. 默认值（最低优先级）

## 2. 配置分组（建议）

### 2.1 Server
- `server.port`：监听端口
- `server.base_url`：对外访问地址（用于生成邀请链接等）
- `server.cors.allow_origins`：允许的前端域名列表

### 2.2 Database (PostgreSQL)
- `db.host` / `db.port` / `db.name`
- `db.user` / `db.password`
- `db.sslmode`
- `db.timezone`：数据库时区（建议 `Asia/Shanghai`）

### 2.3 Redis
- `redis.addr` / `redis.password` / `redis.db`

### 2.4 Auth (JWT)
- `auth.jwt_secret`：JWT 签名密钥
- `auth.access_token_ttl`：Access Token 有效期（例如 15 分钟）
- `auth.refresh_token_ttl_default`：未勾选“记住我”时的 Refresh Token 有效期（例如 24 小时）
- `auth.refresh_token_ttl_remember_me`：勾选“记住我”时的 Refresh Token 有效期（例如 7 天）
- `auth.cookie.secure` / `auth.cookie.same_site` / `auth.cookie.domain`

### 2.5 Mail
- `mail.smtp_host` / `mail.smtp_port`
- `mail.username` / `mail.password`
- `mail.from`

### 2.6 Features
- `feature.oa_import_enabled`：OA 课表导入开关（V1建议关闭，仅支持 ICS）

### 2.7 Observability
- `log.level` / `log.format`
- `trace.enabled`（可选）

## 3. 安全建议

- 所有密钥类配置（DB 密码、JWT secret、SMTP 密码）不要提交到仓库。
- 生产环境建议通过 Secret Manager 或 CI/CD 注入环境变量。
