# 信息结构图（IA）
# 学生会值班管理系统

| 文档信息 | |
|---|---|
| 版本号 | v1.0 |
| 创建日期 | 2026-01-28 |
| 关联PRD | PRD-值班管理系统.md |
| 关联SRS | SRS-软件需求规格说明.md |

---

## 1. IA 范围与原则

- 本 IA 描述 Web 端信息架构、导航与页面分组，用于对齐：权限、菜单、关键流程入口与信息呈现。
- IA 不包含具体技术实现、API、数据库设计。
- 角色：值班成员、部门负责人、排班管理员。

---

## 2. 全局导航（Top-level）

> **v2 重构**：去掉侧边栏，改为顶部导航栏。管理员柅台以 Stepper 向导集成全流程，普通成员柅台由待办驱动。

**一期已实现导航项：**

| 导航项 | URL | 可见见角色 | 说明 |
|--------|-----|-----------|------|
| 工作台 | `/` | 全部 | 角色分流：admin → Stepper向导；leader/member → 待办驱动 |
| 用户管理 | `/users` | admin | 含“成员列表 \| 部门管理 \| 学期管理” Tab |
| 个人中心 | `/profile` | 全部 | 头像下拉 |
| 登录 | `/login` | 公开 | |

**二期保留导航项（未实现）：** 换班管理、签到签退、通知中心（全站推送）

说明：不同角色看到的菜单项不同（见第 4 节）。

---

## 3. 站点地图（Sitemap）

> 以功能域组织页面；括号内为主要访问角色。

### 3.1 公共与账号

- 登录（所有人）
- ~~注册~~（**已废弃**：改为管理员批量导入 + 学号默认密码）
- 找回/重置密码（所有人）
- 个人中心（所有人）
  - 我的资料
  - 修改密码
  - 我的通知设置（仅偏好：是否接收邮件等；业务触发由系统配置控制）

### 3.2 工作台

- 工作台（所有人）
  - 今日/明日值班提示（成员）
  - 待处理换班（成员/管理员）
  - 时间表提交状态提醒（成员）
  - 部门提交进度（负责人）
  - 全局提交进度与卡点（管理员）

### 3.3 时间表（课表 + 不可用）

- 我的时间表（成员）
  - 导入课表：OA 导入 ⚠️ V1延期
  - 导入课表：ICS 上传
  - 日历标记不可用时间
  - 提交时间表
  - 提交状态与最后提交时间
- 部门时间表进度（部门负责人）
  - 成员列表（仅“需要值班”成员）
  - 状态筛选：未提交 / 已提交
- 全局时间表进度（管理员）
  - 按部门汇总
  - 未提交名单

### 3.4 排班（查看、生成、调整、发布）

- 排班概览（成员/负责人/管理员）
  - 视图切换：日历视图（单双周）/列表视图
  - 筛选：部门、成员（管理员/负责人可用）
  - 我的排班（成员）
- 自动排班（管理员）
  - 排班前检查（提交率=100%门禁）
  - 排班结果预览（草稿）
  - 无法排班时段清单与原因概览
- 手动调整（管理员）
  - 修改某个时段值班人员（含规则检查）
- 发布与变更（管理员）
  - 发布排班
  - 发布后修改（含变更记录与二次通知）
  - 变更记录列表（按学期、时间、操作人筛选）

### 3.5 换班

- 我的换班（成员）
  - 发起换班（从“我的排班”入口）
  - 我发起的：状态跟踪
  - 我收到的：同意/拒绝
- 换班审核（管理员）
  - 待审核列表
  - 详情页（校验目标成员冲突与同日限制；显示校验结果）
  - 审批：批准/驳回
- 换班记录（成员/管理员）
  - 成员仅可查看与自己相关的记录
  - 管理员可查看全量

### 3.6 签到签退与出勤

- 我的值班与签到（成员）
  - 今日值班卡片（签到/签退按钮）
  - 我的出勤记录（准时/迟到/缺席/缺席已补签/未签退）
  - 缺席后补签入口（仅在被标记缺席后出现）
- 出勤异常（管理员）
  - 缺席列表
  - 未签退列表
  - 异常详情（含通知发送记录/时间线）

### 3.7 通知/消息

- 通知中心（所有人）
  - 系统通知（排班发布/变更）
  - 换班通知（申请/同意/拒绝/审核结果）
  - 出勤异常通知（管理员）

### 3.8 人员与组织

- 部门列表（管理员）
  - 新增/编辑/停用
- 成员与角色（管理员）
  - 成员列表
  - 角色分配
- 勾选需要值班人员（部门负责人/管理员）
  - 本部门成员列表
  - 勾选/取消勾选“需要值班”

### 3.9 系统配置

- 学期配置（管理员）
- 时间段配置（管理员）
- 排班规则开关（管理员）
- 换班截止时间配置（管理员）
- 通知策略配置（管理员）
  - 值班提醒发送时间（默认 09:00）
- 值班地点（管理员）
  - 当前仅一个地点（全局）

### 3.10 导出

- 导出排班表（管理员，P1）—— 已集成到排班页面内的导出按钮，不再作为独立页面
- 导出签到统计（管理员，P1）

---

## 3A. 信息结构图（ASCII 版）

> 用于快速对齐导航层级与页面归属（不代表路由命名）。

```
学生会值班管理系统
│─ 公共与账号
│  ├─ 登录
│  ├─ ~~注册~~（已废弃）
│  └─ 找回/重置密码
├─ 工作台
│  └─ 工作台（按角色显示卡片/待办）
├─ 时间表
│  ├─ 我的时间表（成员）
│  │  ├─ OA 导入 ⚠️ V1延期
│  │  ├─ ICS 上传
│  │  ├─ 日历标记不可用
│  │  └─ 提交时间表（门禁：提交率=100%）
│  ├─ 部门时间表进度（负责人）
│  └─ 全局时间表进度（管理员）
├─ 排班
│  ├─ 排班概览（所有人）
│  │  ├─ 日历视图（单双周）
│  │  └─ 列表视图
│  ├─ 自动排班（管理员）
│  ├─ 手动调整（管理员）
│  └─ 发布与变更（管理员）
│     ├─ 发布排班
│     ├─ 发布后修改
│     └─ 变更记录
├─ 换班
│  ├─ 我的换班（成员）
│  │  ├─ 我发起的
│  │  └─ 我收到的（同意/拒绝）
│  ├─ 换班审核（管理员）
│  └─ 换班记录
├─ 签到签退
│  ├─ 今日值班（签到/签退）
│  ├─ 我的出勤记录
│  └─ 出勤异常（管理员：缺席/未签退）
├─ 通知中心
│  ├─ 系统通知（排班发布/变更）
│  ├─ 换班通知
│  └─ 出勤异常通知（管理员）
├─ 人员与组织
│  ├─ 部门管理（管理员）
│  ├─ 成员与角色（管理员）
│  └─ 勾选需要值班人员（负责人/管理员）
├─ 系统配置（管理员）
│  ├─ 学期配置
│  ├─ 时间段配置
│  ├─ 规则开关
│  ├─ 换班截止时间
│  ├─ 通知策略（提醒时间默认09:00）
│  └─ 值班地点（全局单地点）
├─ 导出（管理员，P1）—— 排班表导出已集成到排班页面
│  ├─ 导出排班表（集成到排班页）
│  └─ 导出签到统计
├─ 提交进度（管理员/部门负责人）
│  ├─ 全局提交进度（管理员：按部门汇总 + 未提交名单）
│  └─ 部门提交进度（部门负责人：本部门成员列表）
└─ 个人中心
  ├─ 我的资料
  ├─ 修改密码
  └─ 通知偏好
```

---

## 4. 角色视角菜单（Navigation by Role）

> **v2 重构**：一期已实现的导航精简为工作台 + 用户管理 + 个人中心，业务功能集成在工作台内部。

### 4.1 值班成员

- 工作台（待办驱动）
  - collecting 阶段 + 未提交：内嵌时间表填写区
  - collecting 阶段 + 已提交：等待提示卡片
  - scheduling 阶段：排班进行中提示
  - published 阶段：「排班已发布」+ 下方我的排班视图（只读）
- 个人中心

关键入口：
- 工作台时间表填写区（collecting 阶段）
- 工作台「查看我的排班」（published 阶段）

### 4.2 部门负责人

- 工作台（待办驱动 + 本部门提交进度折叠面板）
- 个人中心

关键入口：
- 工作台「本部门提交进度」展开（collecting 阶段）

### 4.3 排班管理员

- 工作台（AdminWorkbench 四步 Stepper）
  - Step 1（configuring）：时间段配置 / 地点配置 / 排班规则
  - Step 2（collecting）：值班人员勾选 → 激活排班
  - Step 3（scheduling）：提交进度监控 / 自动排班 / 手动调整
  - Step 4（published）：排班结果预览 / 发布 / 导出
- 用户管理（/users）：成员列表 | 部门管理 | 学期管理
- 个人中心

关键入口：
- Step 2「激活排班」按钮 → Phase: configuring → collecting
- Step 3「开始自动排班」按钮（提交率=100%）
- Step 4「发布排班表」按钮 → Phase: scheduling → published（自动）

---

## 5. 关键页面信息结构（Page-level IA）

### 5.1 我的时间表（成员）

- 顶部：学期选择（只读或自动取当前学期）
- 主体：日历（周视图默认）
  - 有课（灰色块）
  - 不可用（橙色块）
- 右侧/底部：操作区
  - OA 导入 ⚠️ V1延期
  - ICS 上传
  - 新增不可用时间
  - 提交时间表（显示：未提交/已提交、提交时间）

### 5.2 排班概览（所有人）

- 视图：单双周切换 + 周几列
- 卡片：每个班次显示
  - 时间段
  - 值班人员
  - 部门
  - 地点（全局固定）
- 成员侧：提供“仅看我的”开关

### 5.3 换班详情（成员/管理员）

- 基本信息：原班次时间、原值班人、目标成员
- 状态：待同意/待审核/已完成/已拒绝
- 校验结果（成员发起与管理员审核页均可见）：
  - 目标成员课表/不可用冲突：通过/不通过
  - 目标成员同日是否已有其他班次：通过/不通过
- 动作：同意/拒绝（目标成员）；批准/驳回（管理员）

### 5.4 出勤异常（管理员）

- Tab：缺席 / 未签退
- 列表字段：成员、部门、班次、状态、触发时间
- 详情：时间线（应到/签到/缺席/补签/签退）+ 通知记录

---

## 5A. 关键页面线框（极简版 / ASCII）

### 5A.1 工作台（成员）

```
┌─────────────────────────────────────────────────────────────┐
│ 顶部栏：Logo | 工作台 | 排班 | 换班 | 签到 | 通知 | 我       │
├─────────────────────────────────────────────────────────────┤
│ 今日值班卡片                                                   │
│  - 日期：2026-xx-xx  周x                                       │
│  - 时间段：08:10-10:05                                         │
│  - 地点：学生会办公室                                          │
│  [签到]（窗口内可用）   [签退]（窗口内可用）                   │
├─────────────────────────────────────────────────────────────┤
│ 明日提醒（如有）                                               │
│  - 明日 14:00-16:00 值班（邮件将按配置时间发送）               │
├─────────────────────────────────────────────────────────────┤
│ 待办                                                           │
│  - 待处理换班请求 x 条  -> 进入“换班-我收到的”                  │
│  - 时间表状态：未提交/已提交（显示最后提交时间）               │
└─────────────────────────────────────────────────────────────┘
```

### 5A.2 我的时间表（成员）

```
┌─────────────────────────────────────────────────────────────┐
│ 我的时间表（当前学期）                                        │
│ 提交状态：未提交/已提交（提交时间：yyyy-mm-dd hh:mm）          │
├─────────────────────────────────────────────────────────────┤
│ 操作区： [ICS上传] [新增不可用]                   [提交时间表] │
├─────────────────────────────────────────────────────────────┤
│ 周视图日历（可拖拽选择）                                       │
│  周一  周二  周三  周四  周五 ...                              │
│  灰色=有课   橙色=不可用（原因可选）                            │
│  拖拽 -> 弹窗：开始/结束/原因/重复（单次/每周）                 │
└─────────────────────────────────────────────────────────────┘
```

### 5A.3 排班概览（成员）

```
┌─────────────────────────────────────────────────────────────┐
│ 排班概览  [单周] [双周]   视图：[日历] [列表]   仅看我的[√]     │
├─────────────────────────────────────────────────────────────┤
│ 日历：按周一~周五列 + 时间段行                                 │
│  08:10-10:05 | 张三（宣传部） | 地点：学生会办公室              │
│  10:20-12:15 | —（无）                                          │
│  ...                                                            │
└─────────────────────────────────────────────────────────────┘
```

### 5A.4 发起换班（成员：从“我的排班”进入）

```
┌─────────────────────────────────────────────────────────────┐
│ 发起换班                                                      │
├─────────────────────────────────────────────────────────────┤
│ 要换的班次：2026-xx-xx 14:00-16:00（只读）                      │
│ 目标成员： [下拉选择]（仅展示：无课表/不可用冲突 且当日无其他班次）│
│ 原因：   [可选输入]                                            │
├─────────────────────────────────────────────────────────────┤
│ 校验结果（实时）：                                             │
│  - 课表/不可用冲突：通过/不通过                                │
│  - 同日已有班次：通过/不通过                                  │
├─────────────────────────────────────────────────────────────┤
│ [取消]                                         [提交申请]       │
└─────────────────────────────────────────────────────────────┘
```

### 5A.5 换班审核（管理员）

```
┌─────────────────────────────────────────────────────────────┐
│ 换班审核（待审核列表）                                        │
├─────────────────────────────────────────────────────────────┤
│ 列表：申请人 | 目标成员 | 班次 | 状态 | 提交时间 | [查看]       │
├─────────────────────────────────────────────────────────────┤
│ 详情页（查看）                                                 │
│  - 班次：2026-xx-xx 14:00-16:00  地点：学生会办公室            │
│  - A：李四（部门）  ->  B：王五（部门）                         │
│  - 校验（审核时再次校验）：                                    │
│     * B 课表/不可用冲突：通过/不通过                           │
│     * B 同日已有班次：通过/不通过                              │
│  - 原因：...                                                   │
│  [驳回]                                    [批准并更新排班]     │
└─────────────────────────────────────────────────────────────┘
```

### 5A.6 签到/签退（成员）

```
┌─────────────────────────────────────────────────────────────┐
│ 今日值班                                                      │
├─────────────────────────────────────────────────────────────┤
│ 班次：08:10-10:05  地点：学生会办公室                          │
│ 当前状态：未签到/迟到/缺席/缺席（已补签）/已完成/未签退        │
│ 时间窗口：                                                    │
│  - 签到：开始前15min ~ 开始后15min                             │
│  - 签退：结束前15min ~ 结束后15min                             │
├─────────────────────────────────────────────────────────────┤
│ [签到]（窗口内可点）   [签退]（需先签到且窗口内可点）           │
│ 缺席后补签：若被标记缺席，显示 [补签]（记录补签并通知管理员）   │
└─────────────────────────────────────────────────────────────┘
```

### 5A.7 发布后修改与变更记录（管理员）

```
┌─────────────────────────────────────────────────────────────┐
│ 排班发布与变更                                                │
├─────────────────────────────────────────────────────────────┤
│ [发布排班]（草稿时可用）   [发布后修改]（已发布时可用）         │
├─────────────────────────────────────────────────────────────┤
│ 变更记录（列表）                                              │
│  时间 | 操作人 | 班次 | 原值班人 -> 新值班人 | 原因 | 通知状态   │
└─────────────────────────────────────────────────────────────┘
```

---

## 6. 命名与一致性约定

- “时间表”统一指：课表 + 不可用时间（提交状态用于门禁）。
- “需要值班”统一指：由部门负责人勾选进入排班范围的成员。
- “排班表状态”建议仅暴露两种用户可理解的状态：草稿 / 已发布（更细状态由流程文档定义）。

---

## 7. 待后续补充（可选）

- 文案与空状态（无值班/无换班/提交率未达100%）
- 更细的交互规格（例如：日历拖拽弹窗字段校验、筛选条件、批量操作）
